<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Privacy Policy - Malaysia Proptech Association</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
        <!-- Header Placeholder -->
    <div class="header-placeholder"></div>

<!-- Hero Section -->
    <section class="page-hero">
        <div class="container">
            <div class="hero-content">
                <h1 data-translate="privacy-title">Privacy Policy</h1>
                <p data-translate="privacy-subtitle">Protecting your personal data and ensuring transparency in how we handle your information</p>
            </div>
            <div class="hero-image">
                <img src="https://images.pexels.com/photos/3183150/pexels-photo-3183150.jpeg?w=600&h=400&fit=crop&crop=center" alt="Privacy Policy">
            </div>
        </div>
    </section>

    <!-- Privacy Policy Content -->
    <section class="privacy-content">
        <!-- Privacy Policy Content Display -->
        <div class="container">
            <div class="privacy-content-display" id="privacyContent">
                <!-- Content will be loaded here dynamically -->
            </div>
        </div>

        <!-- Download Section -->
        <div class="container">
            <div class="download-section">
                <h3 data-translate="download-policy">Download Privacy Policy</h3>
                <p data-translate="download-description">Download the privacy policy in your preferred language</p>
                <div class="download-buttons">
                    <a href="MPA%20-%20Privacy%20Policy%20-%20English.pdf" class="btn-outline" download>
                        <i class="fas fa-download"></i>
                        <span data-translate="download-english">English PDF</span>
                    </a>
                    <a href="MPA%20-%20Privacy%20Policy%20-%20Bahasa.pdf" class="btn-outline" download>
                        <i class="fas fa-download"></i>
                        <span data-translate="download-bahasa">Bahasa Malaysia PDF</span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Cookie Consent Banner -->
    <div class="cookie-banner" id="cookieBanner">
        <div class="container">
            <div class="cookie-content">
                <div class="cookie-text">
                    <h4 data-translate="cookie-title">Cookie & Privacy Notice</h4>
                    <p data-translate="cookie-text">We use cookies and similar technologies to enhance your browsing experience, analyze site traffic, and personalize content. By continuing to use our website, you consent to our use of cookies in accordance with our Privacy Policy.</p>
                </div>
                <div class="cookie-actions">
                    <button class="btn-primary" id="acceptCookies" data-translate="accept-cookies">Accept All</button>
                    <button class="btn-outline" id="rejectCookies" data-translate="reject-cookies">Reject</button>
                    <a href="privacy-policy.html" class="btn-outline" data-translate="learn-more">Learn More</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Placeholder -->
    <div class="footer-placeholder"></div>

    <script src="script.js"></script>
    <script src="js/components.js"></script>
    <script src="scripts/header-loader.js"></script>
    <script src="scripts/footer-loader.js"></script>
    <script>
        // Privacy Policy specific functionality
        document.addEventListener('DOMContentLoaded', function() {
            const privacyContent = document.getElementById('privacyContent');

            // Function to update privacy policy content based on language
            window.updatePrivacyPolicyContent = function(lang) {
                console.log('updatePrivacyPolicyContent called with lang:', lang, 'on page:', window.location.pathname); // Debug
                
                let markdownFile;
                
                if (lang === 'bm') {
                    markdownFile = 'MPA_Privacy_Policy_Bahasa.md';
                } else if (lang === 'cn') {
                    markdownFile = 'MPA_Privacy_Policy_Chinese.md';
                } else {
                    // Default to English for 'en'
                    markdownFile = 'MPA_Privacy_Policy_English.md';
                }
                
                // Load markdown content
                console.log('Attempting to fetch:', markdownFile); // Debug
                fetch(markdownFile)
                    .then(response => {
                        console.log('Fetch response status:', response.status); // Debug
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.text();
                    })
                    .then(content => {
                        console.log('Content loaded successfully, length:', content.length); // Debug
                        // Convert markdown to HTML (basic conversion)
                        const htmlContent = convertMarkdownToHtml(content);
                        privacyContent.innerHTML = htmlContent;
                    })
                    .catch(error => {
                        console.error('Error loading privacy policy content:', error);
                        privacyContent.innerHTML = '<p>Error loading privacy policy content. Please try again.</p>';
                    });
                
                console.log('Loading markdown file:', markdownFile); // Debug
            };

            // Basic markdown to HTML converter
            function convertMarkdownToHtml(markdown) {
                let html = markdown;
                
                // Convert headers
                html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
                html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
                html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');
                
                // Convert bold text
                html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                
                // Convert italic text
                html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
                
                // Convert lists
                html = html.replace(/^- (.*$)/gim, '<li>$1</li>');
                html = html.replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>');
                
                // Convert line breaks
                html = html.replace(/\n\n/g, '</p><p>');
                html = html.replace(/\n/g, '<br>');
                
                // Wrap in paragraphs
                html = '<p>' + html + '</p>';
                
                // Clean up empty paragraphs
                html = html.replace(/<p><\/p>/g, '');
                html = html.replace(/<p><br><\/p>/g, '');
                
                return html;
            }

            // Make the function globally available
            window.updatePrivacyPolicyContent = updatePrivacyPolicyContent;

            // Initialize with current language
            const currentLang = localStorage.getItem('selectedLanguage') || 'en';
            
            // Override the default language selection for privacy policy page
            const originalSelectLanguage = window.selectLanguage;
            window.selectLanguage = function(lang) {
                // Call original function for navigation and other translations
                if (originalSelectLanguage) {
                    originalSelectLanguage(lang);
                }
                
                // Update privacy policy content
                updatePrivacyPolicyContent(lang);
            };
            
            // Load content immediately
            updatePrivacyPolicyContent(currentLang);
            
            // Fallback: try loading again after a short delay
            setTimeout(() => {
                if (!privacyContent.innerHTML || privacyContent.innerHTML.includes('Content will be loaded')) {
                    console.log('Fallback: Loading privacy policy content...');
                    updatePrivacyPolicyContent(currentLang);
                }
            }, 1000);

            // Cookie Banner
            const cookieBanner = document.getElementById('cookieBanner');
            const acceptCookies = document.getElementById('acceptCookies');
            const rejectCookies = document.getElementById('rejectCookies');

            // Check if user has already made a choice
            const cookieChoice = localStorage.getItem('cookieChoice');
            if (cookieChoice) {
                cookieBanner.style.display = 'none';
            }

            acceptCookies.addEventListener('click', function() {
                localStorage.setItem('cookieChoice', 'accepted');
                cookieBanner.style.display = 'none';
                showNotification('Cookie preferences saved. Thank you!', 'success');
            });

            rejectCookies.addEventListener('click', function() {
                localStorage.setItem('cookieChoice', 'rejected');
                cookieBanner.style.display = 'none';
                showNotification('Cookie preferences saved. Some features may be limited.', 'info');
            });
        });
    </script>
</body>
</html>
