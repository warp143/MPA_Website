# üõ°Ô∏è Malware Cleanup & Remediation Report ‚Äî October 27, 2025

## Executive Summary
On October 27, 2025, after previous detection of critical compromises on proptech.org.my, a new reinfection wave was detected through automated scans. The reinfection source was identified as compromised UpdraftPlus plugin backups and a previously missed infected plugin (`wp-mail-smtp`). A thorough investigation led to full decontamination of the development WordPress instance, analysis of root causes, and aggressive remediation measures.

## Timeline of Events
| Time         | Event                                                    |
|--------------|----------------------------------------------------------|
| 07:21 AM     | UpdraftPlus auto-backup (contaminated backup created)    |
| 08:06 AM     | Initial scan ‚Äî 0 malware files found                     |
| 15:23 PM     | UpdraftPlus runs backup, malware detected in backup      |
| 15:30-16:10  | Automated & manual scans detect 43 malware files         |
| 16:15-22:55  | Malware deleted, UpdraftPlus plugin disabled/removed     |
| 22:57 PM     | Admin password changed                                   |
| 23:06 PM     | Final comprehensive scan ‚Äî 0 malware, system clean       |

## Key Findings
- **52 malware files** detected/removed (Oct 27‚Äì28, see next day's report for second wave)
- **Main infection sources:**
    - Infected UpdraftPlus plugin backups (brought malware back after prior clean)
    - Infected plugin: `wp-mail-smtp` (39 malicious ELF/Perl/cryptominer files)
- **Malware characteristics:**
    - ELF 32/64-bit binaries and Perl scripts, 8-char random filenames
    - Located in valid plugin/theme/assets/upload directories
    - BuildID hashes match prior October 24 attack signatures (regenerated from backups)
- **Cron jobs and malicious persistence eliminated on local system**

## Artifacts & Technical Evidence
- **Infected Files:**
    - `wp-mail-smtp/` ‚Äî 39 files
    - `wp-content/uploads/2025/` ‚Äî Perl scripts
    - `mpa-image-processor/` ‚Äî ELF miners
    - Other detected locations: `/themes/mpa-custom/`, `akismet/`
- **Bad backup files:** All UpdraftPlus backups created between Oct 24‚Äì27
- **Sample command lines:**
    - `find wp-content -type f -exec file {} \; | grep "ELF\|Perl script"`
    - `find wp-content/plugins/wp-mail-smtp -type f | xargs rm -f`
    - `rm -rf wp-content/plugins/updraftplus wp-content/updraft`
    - Database: SQL to remove UpdraftPlus settings and cron jobs

## Remediation & Security Steps
1. **Malware removal:**
    - Deleted all ELF/Perl malware from scan results in plugins/themes/uploads
    - Removed entire infected `wp-mail-smtp` plugin
    - Deleted all UpdraftPlus backups and the plugin itself
2. **Database cleanup:**
    - Removed UpdraftPlus options and scheduled tasks using SQL
3. **Verification:**
    - Multiple comprehensive scans post-cleanup (see Appendix A in source)
    - WordPress core file verification against clean checksum and headers
    - File count monitoring ‚Äî stability confirmed (1,970 files)
4. **Password hardening:**
    - All admin credentials updated (see password history for reference)

## Lessons Learned
- **Backups can be a persistent attack vector** ‚Äî always verify backup integrity before restoring or extracting
- **Malware can hide in rarely-checked plugins** (and in trusted locations like UpdraftPlus or mail plugins)
- **Comprehensive removal must include file system, plugins, backups, cron, and database**
- **Repeated scanning is critical** ‚Äî automated and as part of every change
- **Password management is an essential followup step**

## Recommendations
- Always check and clean backups _before_ use (with file and signature scans)
- Remove any plugin found infected in bulk ‚Äî download a fresh version from WordPress.org
- Disable/replace UpdraftPlus and verify no additional scheduled tasks remain
- Continue hourly/daily malware scan monitoring (as implemented)
- Enforce minimum password standards and rotate credentials for every admin after incident

---

*See Appendix of original report for full file inventory, BuildIDs, and command list. This report covers remediation through the end of October 27; next-day reinfection (second source/backup vector) covered in October 28 report.*
