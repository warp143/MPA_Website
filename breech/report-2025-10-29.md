# üõ°Ô∏è Full Malware/Backdoor Incident Report ‚Äî October 29, 2025

## Executive Summary
On October 29, 2025, a full-system malware scan of Malaysia Proptech Association‚Äôs WordPress occurred, driven by discovery of a sophisticated 83-line functions.php backdoor and SocGholish JavaScript malware. The scan analyzed every file and recent change, revealing both lingering backdoor code and historical attack patterns‚Äîresulting in final deep cleanup, lockout of attacker persistence mechanisms, and system-wide validation.

## Timeline
| Time                | Event                                                        |
|---------------------|--------------------------------------------------------------|
| 10:23 AM            | SocGholish malware alerted by Norton, targeted JS discovered |
| 10:30‚Äì11:15 AM      | SocGholish cleaned, backdoor found in functions.php (83 lines)|
| 10:45‚Äì11:15 AM      | Full scan (6,045 files, 16 patterns), all backdoors analyzed  |
| 11:15 AM            | All backdoor code removed (both sections, server/local)      |
| Post-11:30 AM       | Verification, system confirmed clean                         |

## Major Discoveries
- **83-line WordPress functions.php persistent backdoor:**
    - Created hidden admin user (‚Äúroot‚Äù/‚Äúadmin@wordpress.com‚Äù) auto-recreated on every load
    - Hides user from admin lists, protects from deletion, manipulates counts
    - Completely removed (both major sections, remnants found and eliminated)
- **SocGholish malware (JavaScript injection, main.js):**
    - Detected and removed promptly
    - No further related script infection found
- **Exhaustive scan (6,045 files, 16 patterns):**
    - Searched for PHP and JS backdoors, obfuscated code, suspicious plugins, and signs of new or lingering compromise
- **Timestamp/twin file anomalies:**
    - Dozens of files (esp. themes/) showed mass-modification at midnight‚Äîattributed to restoration procedure, not further attack
    - 18 file duplicates with ‚Äú 2.php‚Äù (macOS backup behavior)‚Äîcleaned and flagged for removal
- **Plugin anomalies investigated:**
    - No suspicious plugin binaries remained, Wordfence rules active
    
## Technical Forensics
- **Functions.php backdoor:**
    - Two code blocks: (A) User hiding/protection (_pre_user_id, query filtering, count hiding) & (B) Root user creation (auto recreate, fake admin email)
    - Patterns: `wp_insert_user`, `admin@wordpress.com`, `_pre_user_id`, protect_user* functions
    - Backup/remnants isolated and preserved in malware_samples/
- **SocGholish malware:**
    - JavaScript injection: external domain, async script injection, removed from both server and local
    - All backup, plugin, and theme files cross-checked for persistence
- **Comprehensive scans:** (see original for all commands/patterns)
    - ELF/perl binaries: 0; Random file names: 0; JS:¬±, all legit after cleanup
    - Confirmed core, plugins, themes clear of all ‚Äúroot‚Äù account, backdoor code, eval/base64_decode, hex2bin, suspicious scripts
- **User verification:**
    - No ‚Äúroot‚Äù/‚Äúadmin@wordpress.com‚Äù/etc. accounts exist post-cleanup (via WP CLI)

## Remediation/Actions
- Backdoor fully removed (83 lines from all envs)
- All JavaScript malware eliminated (main.js and any related backup files)
- Disabled theme/plugin file editor at config (`DISALLOW_FILE_EDIT = true`)
- Additional file-level integrity scan and backup quarantine
- All plugin, core, and backup/test files scanned for IOCs

## Lessons & Recommendations
- Deep backdoors can persist for days even after initial major cleanup‚Äîscan for persistent admin creation, query hiding, and critical string patterns
- JavaScript supply-chain infection (SocGholish) may follow PHP backdoor access; scan both vectors
- Disable theme/plugin editor as part of standard hardening
- Bin and remove all duplicate backup files to avoid confusion
- Continue scheduled, automated malware/integrity scans

---

*(All technical details, signatures, and command/grep patterns included in original comprehensive scan report and in malware_samples/ backup.)*
